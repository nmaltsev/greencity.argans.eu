(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[540],{2540:function(t,e,r){"use strict";r.r(e),r.d(e,{default:function(){return y}});var n=r(1799),i=r(5893),a=r(5516),o=r.n(a),s=r(5243),u=r.n(s),c=(r(5729),r(7294));function l(t){var e=function(t,e){var r=this,n=new XMLHttpRequest;n.onreadystatechange=function(){4===n.readyState&&(200===n.status?e.call(r,n.responseText):e.call(r,"error"))},n.open("GET",t),n.send()},r={};r.Source=t.Layer.extend({options:{untiled:!0,identify:!0},initialize:function(e,r){t.setOptions(this,r),this.options.tiled&&(this.options.untiled=!1),this._url=e,this._subLayers={},this._overlay=this.createOverlay(this.options.untiled)},createOverlay:function(t){var e={};for(var n in this.options)"untiled"!=n&&"identify"!=n&&(e[n]=this.options[n]);return t?r.overlay(this._url,e):r.tileLayer(this._url,e)},onAdd:function(){this.refreshOverlay()},getEvents:function(){return this.options.identify?{click:this.identify}:{}},setOpacity:function(t){this.options.opacity=t,this._overlay&&this._overlay.setOpacity(t)},bringToBack:function(){this.options.isBack=!0,this._overlay&&this._overlay.bringToBack()},bringToFront:function(){this.options.isBack=!1,this._overlay&&this._overlay.bringToFront()},getLayer:function(t){return r.layer(this,t)},addSubLayer:function(t){this._subLayers[t]=!0,this.refreshOverlay()},removeSubLayer:function(t){delete this._subLayers[t],this.refreshOverlay()},refreshOverlay:function(){var t=Object.keys(this._subLayers).join(",");this._map&&(t?(this._overlay.setParams({layers:t}),this._overlay.addTo(this._map)):this._overlay.remove())},identify:function(t){var e=this.getIdentifyLayers();e.length&&this.getFeatureInfo(t.containerPoint,t.latlng,e,this.showFeatureInfo)},getFeatureInfo:function(e,r,n,i){var a=this.getFeatureInfoParams(e,n),o=this._url+t.Util.getParamString(a,this._url);this.showWaiting(),this.ajax(o,(function(t){this.hideWaiting();var e=this.parseFeatureInfo(t,o);i.call(this,r,e)}))},ajax:function(t,r){e.call(this,t,r)},getIdentifyLayers:function(){return this.options.identifyLayers?this.options.identifyLayers:Object.keys(this._subLayers)},getFeatureInfoParams:function(e,r){var n,i;this.options.untiled?n=this._overlay.wmsParams:((i=this.createOverlay(!0)).updateWmsParams(this._map),(n=i.wmsParams).layers=r.join(","));var a={request:"GetFeatureInfo",query_layers:r.join(","),X:Math.round(e.x),Y:Math.round(e.y)};return t.extend({},n,a)},parseFeatureInfo:function(t,e){return"error"==t&&(t="<iframe src='"+e+"' style='border:none'>"),t},showFeatureInfo:function(t,e){this._map&&this._map.openPopup(e,t)},showWaiting:function(){this._map&&(this._map._container.style.cursor="progress")},hideWaiting:function(){this._map&&(this._map._container.style.cursor="default")}}),r.source=function(t,e){return new r.Source(t,e)},r.Layer=t.Layer.extend({initialize:function(e,n,i){t.setOptions(this,i),e.addSubLayer||(e=r.getSourceForUrl(e,i)),this._source=e,this._name=n},onAdd:function(){this._source._map||this._source.addTo(this._map),this._source.addSubLayer(this._name)},onRemove:function(){this._source.removeSubLayer(this._name)},setOpacity:function(t){this._source.setOpacity(t)},bringToBack:function(){this._source.bringToBack()},bringToFront:function(){this._source.bringToFront()}}),r.layer=function(t,e,n){return new r.Layer(t,e,n)};var n={};return r.getSourceForUrl=function(t,e){return n[t]||(n[t]=r.source(t,e)),n[t]},r.TileLayer=t.TileLayer.WMS,r.tileLayer=t.tileLayer.wms,r.Overlay=t.Layer.extend({defaultWmsParams:{service:"WMS",request:"GetMap",version:"1.1.1",layers:"",styles:"",format:"image/jpeg",transparent:!1},options:{crs:null,uppercase:!1,attribution:"",opacity:1,isBack:!1,minZoom:0,maxZoom:18},initialize:function(e,r){this._url=e;var n={},i={};for(var a in r)a in this.options?i[a]=r[a]:n[a]=r[a];t.setOptions(this,i),this.wmsParams=t.extend({},this.defaultWmsParams,n)},setParams:function(e){t.extend(this.wmsParams,e),this.update()},getAttribution:function(){return this.options.attribution},onAdd:function(){this.update()},onRemove:function(t){this._currentOverlay&&(t.removeLayer(this._currentOverlay),delete this._currentOverlay),this._currentUrl&&delete this._currentUrl},getEvents:function(){return{moveend:this.update}},update:function(){if(this._map){this.updateWmsParams();var e=this.getImageUrl();if(this._currentUrl!=e){this._currentUrl=e;var r=this._map.getBounds(),n=t.imageOverlay(e,r,{opacity:0});n.addTo(this._map),n.once("load",(function(){this._map&&(n._url==this._currentUrl?(this._currentOverlay&&this._map.removeLayer(this._currentOverlay),this._currentOverlay=n,n.setOpacity(this.options.opacity?this.options.opacity:1),!0===this.options.isBack&&n.bringToBack(),!1===this.options.isBack&&n.bringToFront()):this._map.removeLayer(n))}),this),(this._map.getZoom()<this.options.minZoom||this._map.getZoom()>this.options.maxZoom)&&this._map.removeLayer(n)}}},setOpacity:function(t){this.options.opacity=t,this._currentOverlay&&this._currentOverlay.setOpacity(t)},bringToBack:function(){this.options.isBack=!0,this._currentOverlay&&this._currentOverlay.bringToBack()},bringToFront:function(){this.options.isBack=!1,this._currentOverlay&&this._currentOverlay.bringToFront()},updateWmsParams:function(e){e||(e=this._map);var r=e.getBounds(),n=e.getSize(),i=parseFloat(this.wmsParams.version),a=this.options.crs||e.options.crs,o=i>=1.3?"crs":"srs",s=a.project(r.getNorthWest()),u=a.project(r.getSouthEast()),c={width:n.x,height:n.y};c[o]=a.code,c.bbox=(i>=1.3&&a===t.CRS.EPSG4326?[u.y,s.x,s.y,u.x]:[s.x,u.y,u.x,s.y]).join(","),t.extend(this.wmsParams,c)},getImageUrl:function(){var e=this.options.uppercase||!1,r=t.Util.getParamString(this.wmsParams,this._url,e);return this._url+r}}),r.overlay=function(t,e){return new r.Overlay(t,e)},r}var h="leaflet-map";var p=["86,1,253","86,84,255","87,169,253","85,255,255","0,255,127","170,255,126","170,255,3","253,255,122","255,255,1","255,248,44","255,229,93","255,171,127","255,170,1","255,137,57","255,85,0","255,3,67"];function y(t){var e=(0,c.useRef)(),r=(0,c.useState)({}),a=r[0];r[1];return(0,c.useEffect)((function(){var t=e.current=u().map(h,{attributionControl:!1,zoom:5,center:[53,0],zoomControl:!1,maxZoom:18,minZoom:3});u().control.zoom({position:"topright"}).addTo(t),u().tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}").addTo(t);var r=u().popup();t.on("click",(function(e){var n=e.latlng;console.log("selectedGeoPoint %s %s",JSON.stringify(e.latlng),e.layerPoint),t.eachLayer((function(e){if(e.hasOwnProperty("__name")&&e.getBounds().contains(n)){var i=function(t,e){t.extent||console.warn("Please use georaster-layer-for-leaflet v3.8.0");var r=t.ymax-e.lat,n=e.lng-t.xmin,i=r*(t.height/t.extent.height),a=n*(t.width/t.extent.width),o=t.georasters.at(e);if(!o)return null;var s=o.values[0][~~i][~~a];return s===o.noDataValue?null:s}(e,n);i&&r.setLatLng(n).setContent("You clicked the map at "+n.toString()+" Value: "+i).openOn(t)}}))})),function(t){var e=l(u()),r=new(u().featureGroup)([]),n=u().tileLayer("https://mt1.google.com/vt/lyrs=s&x={x}&y={y}&z={z}",{opacity:1,attribution:""}),i=u().tileLayer("http://a.tile.openstreetmap.org/{z}/{x}/{y}.png",{opacity:1,attribution:""}),a=u().tileLayer("http://a.basemaps.cartocdn.com/dark_nolabels/{z}/{x}/{y}.png",{opacity:1,attribution:""});t.addLayer(a),t.createPane("pane_CommunedeToulouse_3"),t.getPane("pane_CommunedeToulouse_3").style.zIndex=403,t.getPane("pane_CommunedeToulouse_3").style["mix-blend-mode"]="normal";var o=new(u().geoJson)(json_CommunedeToulouse_3,{attribution:"",pane:"pane_CommunedeToulouse_3",onEachFeature:function(t,e){},style:function(){return{pane:"pane_CommunedeToulouse_3",opacity:1,color:"rgba(194,194,194,0.5)",dashArray:"",lineCap:"butt",lineJoin:"miter",weight:4,fillOpacity:0}}});r.addLayer(o),t.addLayer(o);var s=e.layer("https://greencitylab.terranis.fr/geoserver/tlse_veg/wms?tiled=true","EVs2_tlse_connectivite",{format:"image/png",uppercase:!0,transparent:!0,continuousWorld:!0,tiled:!0,info_format:"text/html",opacity:1,identify:!1,attribution:""});t.addLayer(s),t.createPane("pane_SurfaceseneauOSMcontributors_5"),t.getPane("pane_SurfaceseneauOSMcontributors_5").style.zIndex=405,t.getPane("pane_SurfaceseneauOSMcontributors_5").style["mix-blend-mode"]="normal";var c=new(u().geoJson)(json_SurfaceseneauOSMcontributors_5,{attribution:"",pane:"pane_SurfaceseneauOSMcontributors_5",onEachFeature:function(t,e){},style:function(){return{pane:"pane_SurfaceseneauOSMcontributors_5",opacity:1,color:"rgba(166,206,227,1.0)",dashArray:"",lineCap:"butt",lineJoin:"miter",weight:1,fill:!0,fillOpacity:1,fillColor:"rgba(166,206,227,1.0)"}}});r.addLayer(c),t.addLayer(c),u().control.layers({},{"Surfaces en eau":c,"Connectivit\xe9 des espaces verts":s,"Commune de Toulouse":o,"Fond de carte Dark Matter":a,"Fond de carte OpenStreetMap":i,"Fond de carte Google Satellite":n},{collapsed:!1}).addTo(t)}(t)}),[]),(0,i.jsxs)("div",{className:o().root,children:[(0,i.jsx)("div",{className:o().header}),(0,i.jsxs)("div",{className:o().body,children:[(0,i.jsx)("div",{className:o().map,id:h}),(null===a||void 0===a?void 0:a.max)&&(0,i.jsx)("div",{className:o().legend,children:(0,i.jsx)(Legend,(0,n.Z)({colors:p},a))})]})]})}},5516:function(t){t.exports={root:"Map_root___NerG",header:"Map_header__8vtTN",body:"Map_body__vtjF6",legend:"Map_legend__cofUg",map:"Map_map__18h5L",menu:"Map_menu__BQU5E",selected:"Map_selected__Gc_z7"}},5729:function(){}}]);